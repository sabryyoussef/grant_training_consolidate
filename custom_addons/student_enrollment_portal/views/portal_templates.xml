<?xml version="1.0" encoding="utf-8"?>
<odoo>
    
    <!-- Custom CSS for Course Pages -->
    <template id="assets_frontend" inherit_id="website.assets_frontend">
        <xpath expr="." position="inside">
            <style>
                .hover-shadow {
                    transition: all 0.3s ease;
                }
                .hover-shadow:hover {
                    transform: translateY(-5px);
                    box-shadow: 0 10px 20px rgba(0,0,0,0.2) !important;
                }
                .sticky-top {
                    position: -webkit-sticky;
                    position: sticky;
                }
            </style>
        </xpath>
    </template>
    
    <!-- Public Course Catalog -->
    <template id="public_courses_catalog" name="Public Course Catalog">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure">
                <section class="s_cover pt48 pb48" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-12 text-center text-white">
                                <h1 class="display-4 mb-3">
                                    <i class="fa fa-graduation-cap"/> Our Courses
                                </h1>
                                <p class="lead mb-4">Explore our comprehensive training programs and start your learning journey</p>
                            </div>
                        </div>
                    </div>
                </section>
                
                <section class="pt48 pb48" style="background-color: #f8f9fa;">
                    <div class="container">
                        <t t-if="courses">
                            <div class="row">
                                <t t-foreach="courses" t-as="course">
                                    <div class="col-lg-4 col-md-6 mb-4">
                                        <div class="card h-100 shadow-sm hover-shadow">
                                            <div class="card-body d-flex flex-column">
                                                <h4 class="card-title text-primary">
                                                    <i class="fa fa-book"/> <t t-esc="course.name"/>
                                                </h4>
                                                <p class="card-text text-muted mb-3" t-if="course.code">
                                                    <strong>Code:</strong> <t t-esc="course.code"/>
                                                </p>
                                                <div class="mt-auto">
                                                    <a t-attf-href="/courses/#{course.id}" class="btn btn-outline-primary btn-sm me-2">
                                                        <i class="fa fa-info-circle"/> View Details
                                                    </a>
                                                    <a t-attf-href="/student/register?course_id=#{course.id}" class="btn btn-primary btn-sm">
                                                        <i class="fa fa-user-plus"/> Register Now
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </t>
                            </div>
                        </t>
                        <t t-if="not courses">
                            <div class="alert alert-info text-center" role="alert">
                                <h4><i class="fa fa-info-circle"/> No Courses Available</h4>
                                <p class="mb-0">Please check back later for available courses.</p>
                            </div>
                        </t>
                    </div>
                </section>
            </div>
        </t>
    </template>
    
    <!-- Public Course Detail Page -->
    <template id="public_course_detail" name="Public Course Detail">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure">
                <section class="s_cover pt48 pb48" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-12 text-white">
                                <h1 class="display-4 mb-2">
                                    <t t-esc="course.name"/>
                                </h1>
                                <p class="lead" t-if="course.code">
                                    Course Code: <strong><t t-esc="course.code"/></strong>
                                </p>
                            </div>
                        </div>
                    </div>
                </section>
                
                <section class="pt48 pb48">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-8">
                                <div class="card shadow-sm mb-4">
                                    <div class="card-body">
                                        <h3 class="text-primary mb-3">
                                            <i class="fa fa-info-circle"/> Course Information
                                        </h3>
                                        <div class="row mb-3" t-if="course.subject_id">
                                            <div class="col-md-4">
                                                <strong>Subject:</strong>
                                            </div>
                                            <div class="col-md-8">
                                                <t t-esc="course.subject_id.name"/>
                                            </div>
                                        </div>
                                        <div class="row mb-3" t-if="course.course_level">
                                            <div class="col-md-4">
                                                <strong>Level:</strong>
                                            </div>
                                            <div class="col-md-8">
                                                <t t-esc="course.course_level"/>
                                            </div>
                                        </div>
                                        <div class="row mb-3" t-if="course.duration">
                                            <div class="col-md-4">
                                                <strong>Duration:</strong>
                                            </div>
                                            <div class="col-md-8">
                                                <t t-esc="course.duration"/> <t t-esc="course.duration_type"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="card shadow-sm" t-if="course.description">
                                    <div class="card-body">
                                        <h3 class="text-primary mb-3">
                                            <i class="fa fa-file-text"/> Description
                                        </h3>
                                        <div t-field="course.description" class="text-muted"/>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-lg-4">
                                <div class="card shadow-sm bg-light sticky-top" style="top: 20px;">
                                    <div class="card-body text-center">
                                        <h4 class="text-primary mb-4">
                                            <i class="fa fa-rocket"/> Ready to Start?
                                        </h4>
                                        <p class="text-muted mb-4">
                                            Register now to begin your learning journey with this course.
                                        </p>
                                        <a t-attf-href="/student/register?course_id=#{course.id}" class="btn btn-primary btn-lg w-100 mb-3">
                                            <i class="fa fa-user-plus"/> Register for this Course
                                        </a>
                                        <a href="/courses" class="btn btn-outline-secondary w-100">
                                            <i class="fa fa-arrow-left"/> Back to All Courses
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </t>
    </template>
    
    <!-- Student Registration Form -->
    <template id="portal_student_registration_form" name="Student Registration Form">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure oe_empty">
                <section class="s_cover pt96 pb96" style="background-color: #f8f9fa;">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-8 offset-lg-2">
                                <div class="card shadow-lg">
                                    <div class="card-header bg-primary text-white">
                                        <h3 class="mb-0">
                                            <i class="fa fa-graduation-cap"/> Student Registration
                                        </h3>
                                    </div>
                                    <div class="card-body p-4">
                                        
                                        <!-- Error Messages -->
                                        <t t-if="error_message">
                                            <div class="alert alert-danger" role="alert">
                                                <t t-foreach="error_message" t-as="err">
                                                    <p class="mb-0"><t t-esc="err"/></p>
                                                </t>
                                            </div>
                                        </t>
                                        
                                        <!-- Course Interest Banner -->
                                        <t t-if="selected_course">
                                            <div class="alert alert-info alert-dismissible fade show" role="alert">
                                                <h5 class="alert-heading">
                                                    <i class="fa fa-graduation-cap"/> Course of Interest
                                                </h5>
                                                <p class="mb-0">
                                                    You're registering to enroll in: <strong><t t-esc="selected_course.name"/></strong>
                                                </p>
                                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                                            </div>
                                        </t>
                                        
                                        <form action="/student/register/submit" method="post" enctype="multipart/form-data" class="needs-validation">
                                            
                                            <!-- Personal Information -->
                                            <h5 class="text-primary mb-3">
                                                <i class="fa fa-user"/> Personal Information
                                            </h5>
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label for="student_name_english" class="form-label">Full Name (English) <span class="text-danger">*</span></label>
                                                    <input type="text" class="form-control" id="student_name_english" name="student_name_english" 
                                                           t-att-value="post.get('student_name_english', '')" required="required"/>
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <label for="student_name_arabic" class="form-label">Full Name (Arabic) <span class="text-danger">*</span></label>
                                                    <input type="text" class="form-control" id="student_name_arabic" name="student_name_arabic" 
                                                           t-att-value="post.get('student_name_arabic', '')" required="required" dir="rtl"/>
                                                </div>
                                            </div>
                                            
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label for="birth_date" class="form-label">Birth Date <span class="text-danger">*</span></label>
                                                    <input type="date" class="form-control" id="birth_date" name="birth_date" 
                                                           t-att-value="post.get('birth_date', '')" required="required"/>
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <label for="gender" class="form-label">Gender <span class="text-danger">*</span></label>
                                                    <select class="form-select" id="gender" name="gender" required="required">
                                                        <option value="">Select Gender</option>
                                                        <option value="male" t-att-selected="'selected' if post.get('gender') == 'male' else None">Male</option>
                                                        <option value="female" t-att-selected="'selected' if post.get('gender') == 'female' else None">Female</option>
                                                    </select>
                                                </div>
                                            </div>
                                            
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label for="nationality" class="form-label">Nationality <span class="text-danger">*</span></label>
                                                    <input type="text" class="form-control" id="nationality" name="nationality" 
                                                           t-att-value="post.get('nationality', '')" required="required"/>
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <label for="native_language" class="form-label">Native Language</label>
                                                    <input type="text" class="form-control" id="native_language" name="native_language" 
                                                           t-att-value="post.get('native_language', 'Arabic')"/>
                                                </div>
                                            </div>
                                            
                                            <!-- Contact Information -->
                                            <h5 class="text-primary mb-3 mt-4">
                                                <i class="fa fa-envelope"/> Contact Information
                                            </h5>
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label for="email" class="form-label">Email <span class="text-danger">*</span></label>
                                                    <input type="email" class="form-control" id="email" name="email" 
                                                           t-att-value="post.get('email', '')" required="required"/>
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <label for="phone" class="form-label">Phone <span class="text-danger">*</span></label>
                                                    <input type="tel" class="form-control" id="phone" name="phone" 
                                                           t-att-value="post.get('phone', '')" required="required"/>
                                                </div>
                                            </div>
                                            
                                            <!-- Educational Background -->
                                            <h5 class="text-primary mb-3 mt-4">
                                                <i class="fa fa-book"/> Educational Background
                                            </h5>
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label for="english_level" class="form-label">English Level <span class="text-danger">*</span></label>
                                                    <select class="form-select" id="english_level" name="english_level" required="required">
                                                        <option value="">Select Level</option>
                                                        <option value="beginner" t-att-selected="'selected' if post.get('english_level') == 'beginner' else None">Beginner</option>
                                                        <option value="intermediate" t-att-selected="'selected' if post.get('english_level') == 'intermediate' else None">Intermediate</option>
                                                        <option value="advanced" t-att-selected="'selected' if post.get('english_level') == 'advanced' else None">Advanced</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <div class="form-check mt-4">
                                                        <input class="form-check-input" type="checkbox" id="has_previous_certificate" 
                                                               name="has_previous_certificate" value="1"
                                                               t-att-checked="'checked' if post.get('has_previous_certificate') else None"/>
                                                        <label class="form-check-label" for="has_previous_certificate">
                                                            I have a previous certificate
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row" id="certificate_type_row" style="display: none;">
                                                <div class="col-md-12 mb-3">
                                                    <label for="certificate_type" class="form-label">Certificate Type</label>
                                                    <input type="text" class="form-control" id="certificate_type" name="certificate_type" 
                                                           t-att-value="post.get('certificate_type', '')"/>
                                                </div>
                                            </div>
                                            
                                            <!-- Course Request -->
                                            <h5 class="text-primary mb-3 mt-4">
                                                <i class="fa fa-list"/> Course Request
                                            </h5>
                                            <div class="mb-3">
                                                <label for="requested_courses" class="form-label">Courses You Want to Enroll In</label>
                                                <textarea class="form-control" id="requested_courses" name="requested_courses" 
                                                          rows="3" placeholder="Please list the courses you are interested in..."><t t-if="selected_course"><t t-esc="selected_course.name"/>
</t><t t-esc="post.get('requested_courses', '')"/></textarea>
                                                <t t-if="selected_course">
                                                    <small class="form-text text-success">
                                                        <i class="fa fa-check-circle"/> <strong><t t-esc="selected_course.name"/></strong> has been pre-filled for you
                                                    </small>
                                                </t>
                                            </div>
                                            
                                            <!-- Document Upload -->
                                            <h5 class="text-primary mb-3 mt-4">
                                                <i class="fa fa-file"/> Documents
                                            </h5>
                                            <div class="mb-3">
                                                <label for="documents" class="form-label">Upload Documents (ID, Certificates, etc.)</label>
                                                <input type="file" class="form-control" id="documents" name="documents" multiple="multiple"/>
                                                <small class="form-text text-muted">You can upload multiple files. Accepted formats: PDF, JPG, PNG</small>
                                            </div>
                                            
                                            <!-- Terms and Conditions -->
                                            <div class="form-check mb-4">
                                                <input class="form-check-input" type="checkbox" id="terms" required="required"/>
                                                <label class="form-check-label" for="terms">
                                                    I agree to the terms and conditions <span class="text-danger">*</span>
                                                </label>
                                            </div>
                                            
                                            <!-- Submit Button -->
                                            <div class="text-center">
                                                <button type="submit" class="btn btn-primary btn-lg px-5">
                                                    <i class="fa fa-paper-plane"/> Submit Registration
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            
            <script type="text/javascript">
                // Show/hide certificate type field
                document.getElementById('has_previous_certificate').addEventListener('change', function() {
                    var certTypeRow = document.getElementById('certificate_type_row');
                    if (this.checked) {
                        certTypeRow.style.display = 'block';
                    } else {
                        certTypeRow.style.display = 'none';
                    }
                });
                
                // Initialize on page load
                if (document.getElementById('has_previous_certificate').checked) {
                    document.getElementById('certificate_type_row').style.display = 'block';
                }
            </script>
        </t>
    </template>
    
    <!-- Registration Success Page -->
    <template id="portal_registration_success" name="Registration Success">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure oe_empty">
                <section class="s_cover pt96 pb96" style="background-color: #f8f9fa;">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-6 offset-lg-3">
                                <div class="card shadow-lg text-center">
                                    <div class="card-body p-5">
                                        <div class="mb-4">
                                            <i class="fa fa-check-circle text-success" style="font-size: 80px;"/>
                                        </div>
                                        <h2 class="text-success mb-3">Registration Submitted Successfully!</h2>
                                        <p class="lead mb-4">Thank you for registering with us.</p>
                                        
                                        <div class="alert alert-info">
                                            <h5>Your Registration Number:</h5>
                                            <h3 class="mb-0"><strong><t t-esc="registration_number"/></strong></h3>
                                        </div>
                                        
                                        <div class="mt-4">
                                            <h5>What's Next?</h5>
                                            <ul class="list-unstyled text-start">
                                                <li class="mb-2"><i class="fa fa-check text-success"/> Our team will review your eligibility</li>
                                                <li class="mb-2"><i class="fa fa-check text-success"/> We will verify your documents</li>
                                                <li class="mb-2"><i class="fa fa-check text-success"/> You will receive an email with your login credentials once approved</li>
                                                <li class="mb-2"><i class="fa fa-check text-success"/> You can then enroll in your chosen courses</li>
                                            </ul>
                                        </div>
                                        
                                        <div class="mt-4">
                                            <a href="/" class="btn btn-primary">
                                                <i class="fa fa-home"/> Return to Home
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </t>
    </template>
    
    <!-- My Registration Status Page -->
    <template id="portal_my_registration" name="My Registration Status">
        <t t-call="portal.portal_layout">
            <t t-set="additional_title">My Registration</t>
            <div id="wrap" class="o_portal_wrap">
                <div class="container mt-4">
                    <div class="row">
                        <div class="col-lg-8 offset-lg-2">
                            <div class="card shadow">
                                <div class="card-header bg-primary text-white">
                                    <h3 class="mb-0">
                                        <i class="fa fa-file-text"/> Registration Status
                                    </h3>
                                </div>
                                <div class="card-body">
                                    
                                    <!-- Registration Info -->
                                    <div class="row mb-4">
                                        <div class="col-md-6">
                                            <h5>Registration Number:</h5>
                                            <p class="lead"><strong><t t-esc="registration.name"/></strong></p>
                                        </div>
                                        <div class="col-md-6">
                                            <h5>Current Status:</h5>
                                            <p>
                                                <span t-if="registration.state == 'draft'" class="badge bg-info">New Registration</span>
                                                <span t-if="registration.state == 'submitted'" class="badge bg-warning">Submitted</span>
                                                <span t-if="registration.state == 'eligibility_review'" class="badge bg-primary">Eligibility Review</span>
                                                <span t-if="registration.state == 'document_review'" class="badge bg-primary">Document Review</span>
                                                <span t-if="registration.state == 'approved'" class="badge bg-success">Approved</span>
                                                <span t-if="registration.state == 'rejected'" class="badge bg-danger">Rejected</span>
                                                <span t-if="registration.state == 'enrolled'" class="badge bg-success">Enrolled</span>
                                            </p>
                                        </div>
                                    </div>
                                    
                                    <!-- Progress Indicator -->
                                    <div class="mb-4">
                                        <h5>Review Progress:</h5>
                                        <div class="progress" style="height: 30px;">
                                            <div class="progress-bar" role="progressbar" 
                                                 t-att-style="'width: %s%%' % (20 if registration.state == 'submitted' else 40 if registration.state == 'eligibility_review' else 60 if registration.state == 'document_review' else 80 if registration.state == 'approved' else 100 if registration.state == 'enrolled' else 0)"
                                                 t-att-aria-valuenow="20 if registration.state == 'submitted' else 40 if registration.state == 'eligibility_review' else 60 if registration.state == 'document_review' else 80 if registration.state == 'approved' else 100 if registration.state == 'enrolled' else 0"
                                                 aria-valuemin="0" aria-valuemax="100">
                                                <t t-if="registration.state == 'submitted'">Submitted</t>
                                                <t t-if="registration.state == 'eligibility_review'">Eligibility Review</t>
                                                <t t-if="registration.state == 'document_review'">Document Review</t>
                                                <t t-if="registration.state == 'approved'">Approved</t>
                                                <t t-if="registration.state == 'enrolled'">Enrolled</t>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Review Notes -->
                                    <t t-if="registration.eligibility_notes or registration.document_notes">
                                        <div class="alert alert-info">
                                            <h5><i class="fa fa-info-circle"/> Review Notes:</h5>
                                            <p t-if="registration.eligibility_notes">
                                                <strong>Eligibility:</strong> <t t-esc="registration.eligibility_notes"/>
                                            </p>
                                            <p t-if="registration.document_notes">
                                                <strong>Documents:</strong> <t t-esc="registration.document_notes"/>
                                            </p>
                                        </div>
                                    </t>
                                    
                                    <!-- Rejection Reason -->
                                    <t t-if="registration.state == 'rejected'">
                                        <div class="alert alert-danger">
                                            <h5><i class="fa fa-exclamation-triangle"/> Rejection Reason:</h5>
                                            <p><t t-esc="registration.rejection_reason"/></p>
                                        </div>
                                    </t>
                                    
                                    <!-- Document Upload Section -->
                                    <t t-if="registration.state in ['submitted', 'eligibility_review', 'document_review']">
                                        <div class="mt-4">
                                            <h5>Upload Additional Documents:</h5>
                                            <form t-attf-action="/my/registration/#{registration.id}/upload" method="post" enctype="multipart/form-data">
                                                <div class="mb-3">
                                                    <input type="file" class="form-control" name="documents" multiple="multiple"/>
                                                </div>
                                                <button type="submit" class="btn btn-primary">
                                                    <i class="fa fa-upload"/> Upload Documents
                                                </button>
                                            </form>
                                        </div>
                                    </t>
                                    
                                    <!-- Contact Support -->
                                    <div class="mt-4 text-center">
                                        <a href="/contactus" class="btn btn-outline-primary">
                                            <i class="fa fa-envelope"/> Contact Support
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
    
    <!-- Add Registration Link to Portal Menu -->
    <template id="portal_my_home_registration" name="Portal My Home: Registration" inherit_id="portal.portal_my_home" priority="30">
        <xpath expr="//div[hasclass('o_portal_docs')]" position="inside">
            <t t-call="portal.portal_docs_entry">
                <t t-set="title">My Registration</t>
                <t t-set="url" t-value="'/my/registration'"/>
                <t t-set="placeholder_count" t-value="'registration_count'"/>
            </t>
        </xpath>
    </template>
    
    <!-- Add Available Courses Link to Portal Menu -->
    <template id="portal_my_home_courses" name="Portal My Home: Available Courses" inherit_id="portal.portal_my_home" priority="31">
        <xpath expr="//div[hasclass('o_portal_docs')]" position="inside">
            <t t-call="portal.portal_docs_entry">
                <t t-set="title">Available Courses</t>
                <t t-set="url" t-value="'/my/available-courses'"/>
                <t t-set="placeholder_count" t-value="'course_count'"/>
            </t>
        </xpath>
    </template>
    
    <!-- Add Enrollment Requests Link to Portal Menu -->
    <template id="portal_my_home_enrollment_requests" name="Portal My Home: Enrollment Requests" inherit_id="portal.portal_my_home" priority="32">
        <xpath expr="//div[hasclass('o_portal_docs')]" position="inside">
            <t t-call="portal.portal_docs_entry">
                <t t-set="title">My Enrollment Requests</t>
                <t t-set="url" t-value="'/my/enrollment-requests'"/>
                <t t-set="placeholder_count" t-value="'enrollment_request_count'"/>
            </t>
        </xpath>
    </template>
    
    <!-- Available Courses Page -->
    <template id="portal_available_courses" name="Available Courses">
        <t t-call="portal.portal_layout">
            <t t-set="additional_title">Available Courses</t>
            <div id="wrap" class="o_portal_wrap">
                <div class="container mt-4">
                    <div class="row">
                        <div class="col-12">
                            <div class="card shadow">
                                <div class="card-header bg-primary text-white">
                                    <h3 class="mb-0">
                                        <i class="fa fa-book"/> Available Courses
                                    </h3>
                                </div>
                                <div class="card-body">
                                    <t t-if="courses">
                                        <div class="row">
                                            <t t-foreach="courses" t-as="course">
                                                <div class="col-md-4 mb-4">
                                                    <div class="card h-100">
                                                        <div class="card-body">
                                                            <h5 class="card-title"><t t-esc="course.name"/></h5>
                                                            <p class="card-text" t-if="course.description">
                                                                <t t-esc="course.description[:100]"/>...
                                                            </p>
                                                            <t t-if="course.id not in enrolled_course_ids">
                                                                <a t-attf-href="/my/courses/request/#{course.id}" class="btn btn-primary">
                                                                    <i class="fa fa-plus"/> Request Enrollment
                                                                </a>
                                                            </t>
                                                            <t t-if="course.id in enrolled_course_ids">
                                                                <span class="badge bg-success">Already Enrolled</span>
                                                            </t>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>
                                        </div>
                                    </t>
                                    <t t-if="not courses">
                                        <p class="text-muted">No courses available at this time.</p>
                                    </t>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
    
    <!-- Enrollment Request Form -->
    <template id="portal_enrollment_request_form" name="Enrollment Request Form">
        <t t-call="portal.portal_layout">
            <t t-set="additional_title">Request Course Enrollment</t>
            <div id="wrap" class="o_portal_wrap">
                <div class="container mt-4">
                    <div class="row">
                        <div class="col-lg-8 offset-lg-2">
                            <div class="card shadow">
                                <div class="card-header bg-primary text-white">
                                    <h3 class="mb-0">
                                        <i class="fa fa-graduation-cap"/> Request Enrollment
                                    </h3>
                                </div>
                                <div class="card-body">
                                    
                                    <!-- Error Messages -->
                                    <t t-if="error_message">
                                        <div class="alert alert-danger" role="alert">
                                            <t t-foreach="error_message" t-as="err">
                                                <p class="mb-0"><t t-esc="err"/></p>
                                            </t>
                                        </div>
                                    </t>
                                    
                                    <!-- Already Enrolled Warning -->
                                    <t t-if="existing_enrollment">
                                        <div class="alert alert-warning" role="alert">
                                            <strong>You are already enrolled in this course.</strong>
                                        </div>
                                    </t>
                                    
                                    <!-- Pending Request Warning -->
                                    <t t-if="pending_request">
                                        <div class="alert alert-info" role="alert">
                                            <strong>You have a pending enrollment request for this course.</strong>
                                            <br/>Request Number: <t t-esc="pending_request.name"/>
                                        </div>
                                    </t>
                                    
                                    <t t-if="course">
                                        <div class="mb-4">
                                            <h4><t t-esc="course.name"/></h4>
                                            <p t-if="course.description"><t t-esc="course.description"/></p>
                                        </div>
                                        
                                        <form t-attf-action="/my/courses/request/submit" method="post" class="needs-validation">
                                            <input type="hidden" name="course_id" t-att-value="course.id"/>
                                            
                                            <div class="mb-3">
                                                <label for="batch_id" class="form-label">Batch (Optional)</label>
                                                <select class="form-select" id="batch_id" name="batch_id">
                                                    <option value="">No specific batch</option>
                                                    <t t-foreach="batches" t-as="batch">
                                                        <option t-att-value="batch.id"><t t-esc="batch.name"/></option>
                                                    </t>
                                                </select>
                                            </div>
                                            
                                            <div class="text-center">
                                                <button type="submit" class="btn btn-primary btn-lg" t-att-disabled="existing_enrollment or pending_request">
                                                    <i class="fa fa-paper-plane"/> Submit Enrollment Request
                                                </button>
                                            </div>
                                        </form>
                                    </t>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
    
    <!-- Enrollment Request Success Page -->
    <template id="portal_enrollment_request_success" name="Enrollment Request Success">
        <t t-call="portal.portal_layout">
            <t t-set="additional_title">Request Submitted</t>
            <div id="wrap" class="o_portal_wrap">
                <div class="container mt-4">
                    <div class="row">
                        <div class="col-lg-6 offset-lg-3">
                            <div class="card shadow text-center">
                                <div class="card-body p-5">
                                    <div class="mb-4">
                                        <i class="fa fa-check-circle text-success" style="font-size: 80px;"/>
                                    </div>
                                    <h2 class="text-success mb-3">Enrollment Request Submitted!</h2>
                                    <p class="lead mb-4">Thank you for your enrollment request.</p>
                                    
                                    <div class="alert alert-info">
                                        <h5>Your Request Number:</h5>
                                        <h3 class="mb-0"><strong><t t-esc="request_number"/></strong></h3>
                                    </div>
                                    
                                    <div class="mt-4">
                                        <a href="/my/enrollment-requests" class="btn btn-primary">
                                            <i class="fa fa-list"/> View My Requests
                                        </a>
                                        <a href="/my/available-courses" class="btn btn-outline-primary">
                                            <i class="fa fa-book"/> Browse More Courses
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
    
    <!-- My Enrollment Requests Page -->
    <template id="portal_my_enrollment_requests" name="My Enrollment Requests">
        <t t-call="portal.portal_layout">
            <t t-set="additional_title">My Enrollment Requests</t>
            <div id="wrap" class="o_portal_wrap">
                <div class="container mt-4">
                    <div class="row">
                        <div class="col-12">
                            <div class="card shadow">
                                <div class="card-header bg-primary text-white">
                                    <h3 class="mb-0">
                                        <i class="fa fa-list"/> My Enrollment Requests
                                    </h3>
                                </div>
                                <div class="card-body">
                                    <t t-if="enrollment_requests">
                                        <div class="table-responsive">
                                            <table class="table table-striped">
                                                <thead>
                                                    <tr>
                                                        <th>Request Number</th>
                                                        <th>Course</th>
                                                        <th>Batch</th>
                                                        <th>Request Date</th>
                                                        <th>Status</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <t t-foreach="enrollment_requests" t-as="request">
                                                        <tr>
                                                            <td><strong><t t-esc="request.name"/></strong></td>
                                                            <td><t t-esc="request.course_id.name"/></td>
                                                            <td><t t-if="request.batch_id"><t t-esc="request.batch_id.name"/></t><t t-if="not request.batch_id">-</t></td>
                                                            <td><t t-esc="request.request_date"/></td>
                                                            <td>
                                                                <span t-if="request.state == 'draft'" class="badge bg-info">Draft</span>
                                                                <span t-if="request.state == 'submitted'" class="badge bg-warning">Submitted</span>
                                                                <span t-if="request.state == 'pending'" class="badge bg-primary">Pending</span>
                                                                <span t-if="request.state == 'approved'" class="badge bg-success">Approved</span>
                                                                <span t-if="request.state == 'rejected'" class="badge bg-danger">Rejected</span>
                                                            </td>
                                                        </tr>
                                                    </t>
                                                </tbody>
                                            </table>
                                        </div>
                                    </t>
                                    <t t-if="not enrollment_requests">
                                        <p class="text-muted">You have no enrollment requests yet.</p>
                                        <a href="/my/available-courses" class="btn btn-primary">
                                            <i class="fa fa-book"/> Browse Available Courses
                                        </a>
                                    </t>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
    
    <!-- Website Menu: Courses -->
    <record id="menu_courses" model="website.menu">
        <field name="name">Courses</field>
        <field name="url">/courses</field>
        <field name="parent_id" ref="website.main_menu"/>
        <field name="sequence">50</field>
    </record>
    
    <!-- Website Menu: Student Registration -->
    <record id="menu_student_register" model="website.menu">
        <field name="name">Register</field>
        <field name="url">/student/register</field>
        <field name="parent_id" ref="website.main_menu"/>
        <field name="sequence">51</field>
    </record>
    
</odoo>

